<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Starting user guide draft and notes for the SticsOnR package • SticsRFiles</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Starting user guide draft and notes for the SticsOnR package">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SticsRFiles</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/TO_REUSE_transitional_SticsOnR_doc.html">Starting user guide draft and notes for the SticsOnR package</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/SticsRPacks/SticsRFiles">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Starting user guide draft and notes for the SticsOnR package</h1>
                        <h4 class="author">Patrice Lecharpentier</h4>
            
            <h4 class="date">2019-11-25</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/SticsRPacks/SticsRFiles/blob/master/vignettes/TO_REUSE_transitional_SticsOnR_doc.Rmd"><code>vignettes/TO_REUSE_transitional_SticsOnR_doc.Rmd</code></a></small>
      <div class="hidden name"><code>TO_REUSE_transitional_SticsOnR_doc.Rmd</code></div>

    </div>

    
    
<div id="content-draft-of-the-starting-guide" class="section level2">
<h2 class="hasAnchor">
<a href="#content-draft-of-the-starting-guide" class="anchor"></a>Content draft of the starting guide</h2>
<div id="introduction" class="section level3">
<h3 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h3>
<ul>
<li><p>In this part informations are focusing only the functionnalities related to Stics xml files manipulation and generation (mailing capabilities)</p></li>
<li><p>The generation of wheather files and observations files are not included yet in the package</p></li>
</ul>
</div>
<div id="content" class="section level3">
<h3 class="hasAnchor">
<a href="#content" class="anchor"></a>Content</h3>
<div id="installation" class="section level4">
<h4 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h4>
<p>Before using SticsOnR some dependencies packages must be installed.</p>
<ul>
<li>
<p>CRAN packages (see SticsOnR package DESCRIPTION file)</p>
<ul>
<li>XML (needed by xmlDocument class)</li>
<li>dplyr (for manipulating data.frames, tibbles)</li>
<li>readxl ( loading XL sheets of inputs parameters )</li>
<li>stringr (character strings manipulation)</li>
<li>lubridate ( used by other functions for managing stics output data)</li>
</ul>
</li>
<li>
<p>specific package</p>
<ul>
<li>Classes ( providing xmlDocument class for managing xml data ) The source tar.gz form of the package can be installed from the console</li>
</ul>
</li>
</ul>
<blockquote>
<p>install.packages(“/path/to/Classes_1.1.tar.gz”, repos = NULL, type = “source”)</p>
</blockquote>
<p>or from the <strong>Packages</strong> tab in RStudio selecting <strong>Install from Package archive file (.tar.gz)</strong> in the list</p>
</div>
<div id="package-functions" class="section level4">
<h4 class="hasAnchor">
<a href="#package-functions" class="anchor"></a>Package functions</h4>
<ul>
<li>
<p>Package help</p>
<ul>
<li>in the <strong>Packages</strong> tab in R studio by clicking on package name, access to functions help</li>
<li>in the console : ?function_name</li>
</ul>
</li>
<li>
<p>Main functionnalities</p>
<ul>
<li>
<p>Load an xml file as an xmlDocument object</p>
<ul>
<li>xmldocument</li>
</ul>
</li>
<li>
<p>Get or set parameters values in xmlDocuments</p>
<ul>
<li>get_param_value</li>
<li>get_params_from_doc</li>
<li>get_params_number</li>
<li>set_param_value</li>
</ul>
</li>
<li><p>Save an xmlDocument as an xml file saveXmlDoc</p></li>
<li>
<p>Generate and changes parameters values in xmlDocument objects using a table of parameters</p>
<ul>
<li>gen_ini_doc</li>
<li>gen_sta_doc</li>
<li>gen_tec_doc</li>
<li>gen_usms_doc</li>
<li>gen_sols_doc</li>
</ul>
</li>
<li>
<p>Generate xml files using a table of parameters</p>
<ul>
<li>gen_ini_file</li>
<li>gen_sta_file</li>
<li>gen_tec_file</li>
<li>gen_usms_file</li>
<li>gen_sols_file</li>
</ul>
</li>
<li>
<p>manipulation of xl sheets</p>
<ul>
<li>get_params_from_table</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div id="function-calling-syntax" class="section level4">
<h4 class="hasAnchor">
<a href="#function-calling-syntax" class="anchor"></a>Function calling syntax</h4>
<p>Take care about using optional arguments with default values. In order to be sure to set a value to the right argument (overloading the default one) the best way is to use the named arguments syntax.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Function signature</span></a>
<a class="sourceLine" id="cb1-2" title="2">func &lt;-<span class="st"> </span><span class="cf">function</span>(arg1, <span class="dt">arg2 =</span> <span class="st">"value2"</span>, <span class="dt">arg3 =</span> <span class="st">"value3"</span>) {}</a>
<a class="sourceLine" id="cb1-3" title="3"></a>
<a class="sourceLine" id="cb1-4" title="4"><span class="co"># Right syntax </span></a>
<a class="sourceLine" id="cb1-5" title="5"><span class="kw">func</span>(arg1, <span class="dt">arg3 =</span> <span class="st">"value3"</span>)</a>
<a class="sourceLine" id="cb1-6" title="6"></a>
<a class="sourceLine" id="cb1-7" title="7"><span class="co">#Bad syntax, the "value" is assigned to the 2nd argument of the function</span></a>
<a class="sourceLine" id="cb1-8" title="8"><span class="kw">func</span>(arg1,<span class="st">"value3"</span>)</a></code></pre></div>
</div>
<div id="getting-example-files-and-scripts-included-in-the-package" class="section level4">
<h4 class="hasAnchor">
<a href="#getting-example-files-and-scripts-included-in-the-package" class="anchor"></a>Getting example files and scripts included in the package</h4>
<ul>
<li>Getting inputs XL example file:</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(SticsOnR)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co"># getting the file in the current directory</span></a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw"><a href="../reference/get_inputs_example.html">get_inputs_example</a></span>()</a>
<a class="sourceLine" id="cb2-4" title="4"><span class="co"># getting the file in a specic directory</span></a>
<a class="sourceLine" id="cb2-5" title="5"><span class="kw"><a href="../reference/get_inputs_example.html">get_inputs_example</a></span>(<span class="dt">dest_dir =</span> <span class="st">"/home/plecharpent/Work/workspace"</span>)</a>
<a class="sourceLine" id="cb2-6" title="6"></a>
<a class="sourceLine" id="cb2-7" title="7"><span class="op">&gt;</span><span class="st"> </span>[<span class="dv">1</span>] <span class="st">"inputs_stics_example.xlsx  has been copied in directory  </span></a>
<a class="sourceLine" id="cb2-8" title="8"><span class="st"> /home/plecharpent/Work/workspace"</span></a></code></pre></div>
<ul>
<li>Getting example scripts for producing ini, sols, sta, tec and usms from the package
<ul>
<li>Getting scripts files list</li>
</ul>
</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(SticsRFiles)</a></code></pre></div>
<pre><code>## Learn SticsRFiles at: https://SticsRPacks.github.io/SticsRFiles</code></pre>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1"><span class="kw"><a href="../reference/get_script.html">get_script</a></span>()</a></code></pre></div>
<pre><code>## [1] "generate_ini_files.R" "generate_sols_file.R" "generate_sta_files.R"
## [4] "generate_tec_files.R" "generate_usms_file.R"</code></pre>
<ul>
<li>Getting a script or all scripts</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># a specific</span></a>
<a class="sourceLine" id="cb7-2" title="2"><span class="kw"><a href="../reference/get_script.html">get_script</a></span>(<span class="st">"generate_ini_files.R"</span>)</a>
<a class="sourceLine" id="cb7-3" title="3"><span class="kw"><a href="../reference/get_script.html">get_script</a></span>(<span class="st">"generate_ini_files.R"</span>, <span class="dt">dest_dir =</span> <span class="st">"/path/to/dir"</span>)</a>
<a class="sourceLine" id="cb7-4" title="4"></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="co"># all scripts</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="kw"><a href="../reference/get_script.html">get_script</a></span>(<span class="st">"all"</span>)</a>
<a class="sourceLine" id="cb7-7" title="7"><span class="kw"><a href="../reference/get_script.html">get_script</a></span>(<span class="st">"all"</span>, <span class="dt">dest_dir =</span> <span class="st">"/path/to/dir"</span>)</a></code></pre></div>
<ul>
<li><p>Only adapt the paths / directories and files names. In these scripts the XL file is given just as an example. It will be replaced by by the user ones.</p></li>
<li><p>The table loaded from an XL sheet is entirely used in the examples, but a selection may be made to generate files only for a subset</p></li>
</ul>
</div>
<div id="list-of-constraints-or-limitations" class="section level4">
<h4 class="hasAnchor">
<a href="#list-of-constraints-or-limitations" class="anchor"></a>List of constraints or limitations</h4>
<ul>
<li>
<p>For <code>usms</code> and <code>sols</code> files:</p>
<ul>
<li>For the moment the functions are not taking into account the xml files content update: i.e. parameters values modification for existing <code>usm</code> or <code>sol</code>, or adding new usm or sol. This means that xml sols or usms files are newly generated upon values contained in the xl sheets.</li>
<li>So, all the <strong>usm</strong> or <strong>sol</strong> parameters must be present in the XL sheet</li>
</ul>
</li>
<li>
<p>For <code>tec</code>, <code>sta</code> and <code>ini</code> files :</p>
<ul>
<li><p>Take care with consistency of the base xml file provided to be duplicated and modified with parameters present in XL sheets. Messages will be displayed in case of a misspelled parameter, or an inexistent parameter in the xml file which may correspond to another Stics version than the desired one.</p></li>
<li><p>All the parameters are not mandatory in the XL sheet, only those we want to modify</p></li>
</ul>
</li>
<li>
<p>Note on parameters names syntax</p>
<ul>
<li>The exact parameters names existing in xml files (with respect of case sensitive) must be used generally in XL sheets. But we have added some <strong>shortcuts parameters</strong> names for some of the which are too long or meaningless.</li>
<li>For long parameters names or meaningless a names correspondence list have been added to facilitate xl sheet filling. It have been included while retreiving data from data frame with names replacement for existing ones in the correspondence list.</li>
</ul>
</li>
</ul>
<table class="table">
<caption>List of possible builtin parameters names substitution</caption>
<thead><tr class="header">
<th align="left">shortcuts</th>
<th align="left">real_name</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">julapI</td>
<td align="left">julapI_or_sum_upvt</td>
</tr>
<tr class="even">
<td align="left">doseI</td>
<td align="left">amount</td>
</tr>
<tr class="odd">
<td align="left">julapN</td>
<td align="left">julapN_or_sum_upvt</td>
</tr>
<tr class="even">
<td align="left">doseN</td>
<td align="left">absolute_value/%</td>
</tr>
</tbody>
</table>
<p>To get this correspondance list : call get_parameters_from_table(), as follows</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(knitr)</a>
<a class="sourceLine" id="cb8-2" title="2"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(SticsOnR)</a></code></pre></div>
<pre><code>## Registered S3 method overwritten by 'sensitivity':
##   method    from 
##   print.src dplyr</code></pre>
<pre><code>## Learn SticsOnR at: https://SticsRPacks.github.io/SticsOnR</code></pre>
<pre><code>## 
## Attachement du package : 'SticsOnR'</code></pre>
<pre><code>## The following objects are masked from 'package:SticsRFiles':
## 
##     set_file, set_general, set_ini, set_out_var, set_param, set_plant,
##     set_soil, set_station, set_tec, set_tmp, set_usm</code></pre>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw"><a href="../reference/get_params_from_table.html">get_params_from_table</a></span>()</a></code></pre></div>
<pre><code>## $julapI
## [1] "julapI_or_sum_upvt"
## 
## $doseI
## [1] "amount"
## 
## $julapN
## [1] "julapN_or_sum_upvt"
## 
## $doseN
## [1] "absolute_value/%"</code></pre>
<ul>
<li>But, it is possible to create and provide a personal list through the <code>dict</code> argument of the function. This argument is usable at the moment for producing only <em>tec</em> files. When calling <code>gen_tec_file</code> the argument dict may be set as follows</li>
</ul>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw"><a href="../reference/gen_tec_file.html">gen_tec_file</a></span>(..., <span class="dt">dict =</span> myDict) </a></code></pre></div>
<ul>
<li>
<p>Files names or usms/sols names in xl sheet</p>
<ul>
<li><p>key words for detecting names or file names column: usm_, tec_, ini_, soil_, sta_</p></li>
<li><p>files names : may be either full files names or only file names without any suffix like _tec.xml, _ini.xml or _sta.xml</p></li>
</ul>
</li>
<li><p>Consistency data checks in XL sheets<br>
For the moment <em>no consistency checks</em> functionnalities have been included in the package. So, we must take care of links between xml files names for example files names defined for usms related to names declared in <code>Tec</code>, <code>Station</code>, and so on.</p></li>
<li><p>XL sheets names<br>
XL sheet names are completely free, but must be meaningfull regarding to the kind of parameters they contain.</p></li>
</ul>
</div>
</div>
</div>
<div id="further-works" class="section level2">
<h2 class="hasAnchor">
<a href="#further-works" class="anchor"></a>Further works</h2>
<div id="list-of-improvements" class="section level3">
<h3 class="hasAnchor">
<a href="#list-of-improvements" class="anchor"></a>List of improvements</h3>
<ul>
<li>management of xml files : how to organize a set of files common to all Stics versions and specific files to stics versions</li>
</ul>
</div>
<div id="list-of-functionnalities-not-included-but-guessing-they-will-be-useful" class="section level3">
<h3 class="hasAnchor">
<a href="#list-of-functionnalities-not-included-but-guessing-they-will-be-useful" class="anchor"></a>List of functionnalities not included but, guessing they will be useful</h3>
<ul>
<li><p>add a name or names vector as input arg for all functions gen_<em><em>doc and gen</em></em>_file giving the possibility to produce xml doc or files for a subset of the input table (i.e. for a list of usms names)</p></li>
<li><p>add a functionnality for checking consistency between data contained in XL sheets of xl files of Stics input parameters</p></li>
<li><p>add functionnalities to generate observations and wheather files from XL sheets</p></li>
<li><p>add the possibility to use csv separate files instead of xl sheets (and also consistency checks between them !)</p></li>
<li><p>add a function to store in inst folder in examples and generate templates files for xml files from given files (files templates and operations templates)</p></li>
<li><p>add a function to extract parameters values from an xml file, for a list of parameters names ( get_params_from_xml)</p></li>
</ul>
</div>
<div id="list-of-checks-to-do" class="section level3">
<h3 class="hasAnchor">
<a href="#list-of-checks-to-do" class="anchor"></a>List of checks to do</h3>
<ul>
<li><p>Verify the updating use case of data in xml files for all functions gen_*_doc !</p></li>
<li><p>Make a list of possible unit tests and other tests to write for functions</p></li>
</ul>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#content-draft-of-the-starting-guide">Content draft of the starting guide</a></li>
      <li><a href="#further-works">Further works</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Patrice Lecharpentier, Remi Vezy.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
